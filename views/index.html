<!DOCTYPE html>
<html lang="es">
<head>
    <title>Vehiculos</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
   
     <!-- Bootstrap CSS v5.2.1 -->
     <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT" crossorigin="anonymous">

     <!-- Iconos de Bootstrap -->
     <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.4/font/bootstrap-icons.css">

</head>

<body>

    <div class="container mt-3">
        <div class="card">
            <div class="card-header bg-primary text-light">
                <div class="row">
                    <div class="col-md-6">
                        <strong>LISTA DE VEHICULOS</strong>
                    </div>
                    <div class="col-md-6 text-end">
                        <button class="btn btn-success btn-sm" id="abrir-modal" data-bs-toggle="modal" data-bs-target="#modal-registro-vehiculos">
              <i class="bi bi-plus-circle-fill"></i> Agregar Vehiculo
            </button>
                    </div>
                </div>
            </div>
            <div class="card-body">
                <table class="table table-sm table-striped" id="tabla-vehiculos">
                    <colgroup>
                        <col width="5%">
                        <col width="30%">
                        <col width="25%">
                        <col width="10%">
                        <col width="10%">
                        <col width="10%">
                        <col width="10%">
                    </colgroup>
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>marca</th>
                            <th>modelo</th>
                            <th>año</th>
                            <th>tipocombustible</th>
                            <th>color</th>
                            <th>numeroplaca</th>
                            <th>transmision</th>
                            <th>kilometraje</th>
                            <th>tipovehiculo</th>
                            <th>fechacompra</th>
                        </tr>
                    </thead>
                    <tbody>

     <!-- Agregar datos de prueba -->

         <!-- Fin de container -->

        <!-- Zona de modales -->
      <!-- if you want to close by clicking outside the modal, delete the last endpoint:data-bs-backdrop and data-bs-keyboard -->
     <div class="modal fade" id="modal-registro-vehiculos" tabindex="-1" role="dialog" aria-labelledby="modalTitleId" aria-hidden="true">
         <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered" role="document">
            <div class="modal-content">
              <div class="modal-header bg-secondary text-light">
                 <h5 class="modal-title" id="modalTitleId">Registro de vehiculos</h5>
                     <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                 <div class="modal-body">
             <form id="formulario-vehiculos">
                                            
                                        
                <div class="mb-3">
              <label for="marca" class="form-label">marca</label>
              <select id="marca" class="form-select form-select-sm">
            <option value="">Seleccione</option>
                 <option value="toyota">Toyota</option>
                    <option value="ford">Ford</option>
                                                    
                        </select>
                         </div>
                         <div class="mb-3">
                     <label for="modelo" class="form-label">modelo</label>
                    <select id="modelo" class="form-select form-select-sm">
                         <option value="">Seleccione</option>
                            <option value="corolla">Corolla</option>
                             <option value="focus">Focus</option>
                                                    
                              </select>
                                </div>
                             <div class="mb-3">
                                 <label for="año" class="form-label">año</label>
                              <select id="año" class="form-select form-select-sm">
                          <option value="">Seleccione</option>
                         <option value="">2017</option>
                        <option value="">2018</option>
                     <option value="">2019</option>
                     <option value="">2020</option>
                      <option value="">2021</option>
                     <option value="">2022</option>
                                                   
                        </select>
                        </div>
                        <div class="mb-3">
                    <label for="tipocombustible" class="form-label">tipocombustible</label>
                     <input type="text" class="form-control form-control-sm" id="tipocombustible">
                </div>
                <div class="mb-3">
                         <label for="color" class="form-label">color</label>
         <input type="text" class="form-control form-control-sm" id="color">
                         </div>
                     <div class="mb-3">
               <label for="numeroplaca" class="form-label">numeroplaca</label>
                        <input type="text" name ="placa" maxlength="6" class="form-control form-control-sm" id="numeroplaca">
                      </div>
                    <div class="mb-3">
               <label for="transmision" class="form-label">transmision</label>
                     <input type="text" name ="placa" maxlength="6" class="form-control form-control-sm" id="transmision">
                        </div>
                    <div class="mb-3">
                 <label for="numeroplaca" class="form-label">kilometraje</label>
                     <input type="text" class="form-control form-control-sm" id="kilometraje">
                      </div>
                      <div class="mb-3">
          <label for="tipovehiculo" class="form-label">tipovehiculo</label>
    <select id="tipovehiculo" class="form-select form-select-sm">
                  <option value="">Seleccione</option>
                        <option value="A">Automatico</option>
                    <option value="M">Manual</option>
                                         
                     </select>
                          </div>
                    <div class="mb-3">
                       <label for="fechacompra" class="form-label">fechacompra</label>
                           <input type="date" class="form-control form-control-sm" id="fechacompra">
                    </div>
                     </form>
                        </div>
                        <div class="modal-footer">
                     <button type="button" class="btn btn-secondary btn-sm" data-bs-dismiss="modal">Cancelar</button>
                     <button type="button" class="btn btn-primary btn-sm" id="guardar-vehiculo">Guardar</button>
                 </div>
            </div>
                 </div>
                 </div>


          <!-- Fin zona de modales -->

       <!-- Bootstrap JavaScript Libraries -->
   <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js" integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3" crossorigin="anonymous">
      </script>

      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.min.js" integrity="sha384-7VPbUDkoPSGFnVtYi0QogXtr74QeVeeIs99Qfg5YCF+TidwNdjvaKZX19NZ/e6oz" crossorigin="anonymous">
         </script>

          <!-- jQuery -->
                      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>

                        <script>
                            $(document).ready(function() {

function mostrarVehiculos() {
    $.ajax({
        url: '../controllers/vehiculo.controller.php',
        type: 'POST',
        data: {
            operacion: 'listar'
        },
        dataType: 'text',
        success: function(result) {
            $("#tabla-vehiculos tbody").html(result);
            
        }
    });
}

function registrarVehiculo() {
                //Pendiente de validar...
                if (confirm("¿Está seguro de registrar este nuevo vehiculo?")) {
             $.ajax({
                     url: '../controllers/vehiculo.controller.php',
                     type: 'POST',
                             data: {
                         operacion: 'registrar',
                                 marca: $("#marca").val(),
                                 modelo: $("#modelo").val(),
                                 año: $("#año").val(),
                                 tipocombustible: $("#tipocombustible").val(),
                             color: $("#color").val(),
                             numeroplaca: $("#numeroplaca").val(),
                             transmision: $("#transmision").val(),
                             kilometraje: $("#kilometraje").val(),
                             tipovehiculo: $("#tipovehiculo").val(),
                             fechacompra: $("#fechacompra").val()
                                 },
                         success: function(result) {
                     if (result == "") {
                         //Reiniciar el formulario
                             $("#formulario-vehiculos")[0].reset();

                             //Actualizar la tabla
                         mostrarVehiculos();
                                                    //Cerrar el modal
                         $("#modal-registro-vehiculos").modal('hide');
                                    }
                                  }
                              });
                              
                        }
                  }
                
                  function eliminarVehiculo() {
                    console.log("Eliminado...");
                        }
                                //Eventos
                    $("#guardar-vehiculo").click(registrarVehiculo);

                    // al pulsar click sobre el boton rojo, se elimine el registro
                  //detectaremos eventos de los objetos creados de manera asincrona en...
                    $("#tabla-vehiculos tbody").on("click", ".eliminar", function() {
                         const idvehiculo = $(this).data("idvehiculo");
                         if (confirm("¿esta seguro de proceder?")) {
                              $.ajax({
                                 url: '../controllers/vehiculo.controller.php',
                                 type: 'POST',
                                 data: {
                                 operacion: 'eliminar',
                                 idvehiculo: idvehiculo
                                      },
                                 success: function(result) {
                                    if (result == "") {
                                      eliminarVehiculo(2);
                                             }

                                        }

                                    });
                                }

                             });

                                //Ejecución automática
                                mostrarVehiculos();


                            });

     </script>
</body>

</html>